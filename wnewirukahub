local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
-------------------------------
local player = Players.LocalPlayer
local MOVE_SPEED = 300
local camLockPart = "Head"
local camera =workspace.Camera
--------------------------------
local followPlatform = nil
local currentTween = nil
local followConnection = nil
local wallCheck = true
local bloxFruitsMode = false
local selectedTarget = nil
local moving = false
local camLock = false
local playerView =false
local randomMode = false
local teamCheck = false
local randomTypeNear = true
local espEnabled = false
local boxEspV1Enabled = false
local boxEspV2Enabled = false
local tracerEnabled = false
local useTween = true
local nearestEnemyPos = nil
local aimbotSkill =false
local hitboxSize =Vector3.new(2,2,1)
local hitboxVisible = false
local walkSpeed =16
local speedHack =false
local jumpPower = 50
local jumpHack
local fastAttack = false
local attackRange = 60
local superRange = false
local noClipConnection =nil
local removeAnimationConnection =nil
local removeAnimation =false
-----------------------------
local lastTime = tick()
local frameCount = 0
local fps = 0
-----------------------------
local tracers = {}
local connections = {}
-----------------------------
local function createFollowPlatform(position)
	if followPlatform then
		followPlatform:Destroy()
	end
	followPlatform = Instance.new("Part")
	followPlatform.Size = Vector3.new(4, 1, 4)
	followPlatform.Anchored = true
	followPlatform.CanCollide = false
	followPlatform.Transparency = 1
	followPlatform.Position = position
	followPlatform.Parent = workspace
end

local function destroyFollowPlatform()
	if followPlatform then
		followPlatform:Destroy()
		followPlatform = nil
	end
	if followConnection then
		followConnection:Disconnect()
		followConnection = nil
	end
	if currentTween then
		currentTween:Cancel()
		currentTween = nil
	end
end

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "FollowGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")
local mainFrame = Instance.new("Frame", screenGui)
mainFrame.Size = UDim2.new(0, 450, 0, 300)
mainFrame.Position = UDim2.new(0.3, 0, 0.3, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
mainFrame.BackgroundTransparency = 0.3
mainFrame.BorderSizePixel = 0
mainFrame.ClipsDescendants = true
mainFrame.Active = true
mainFrame.Draggable = true
local mainCorner = Instance.new("UICorner", mainFrame)
mainCorner.CornerRadius = UDim.new(0, 20)
local titleBar = Instance.new("Frame", mainFrame)
titleBar.Size = UDim2.new(1, 0, 0, 35)
titleBar.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
local titleCorner = Instance.new("UICorner", titleBar)
titleCorner.CornerRadius = UDim.new(0, 20)
local titleLabel = Instance.new("TextLabel", titleBar)
titleLabel.Size = UDim2.new(100, 0, 1, 0)
titleLabel.Position = UDim2.new(0, 10, 0, 0)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "Iruka Hub"
titleLabel.TextColor3 = Color3.new(1, 1, 1)
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 20
titleLabel.TextXAlignment = Enum.TextXAlignment.Left
local closeButton = Instance.new("TextButton", titleBar)
closeButton.Size = UDim2.new(0, 30, 0, 30)
closeButton.Position = UDim2.new(1, -32, 0, 2)
closeButton.BackgroundColor3 = Color3.fromRGB(180, 50, 50)
closeButton.TextColor3 = Color3.new(1, 1, 1)
closeButton.Text = "×"
closeButton.Font = Enum.Font.GothamBold
closeButton.TextSize = 40
local closeCorner = Instance.new("UICorner", closeButton)
closeCorner.CornerRadius = UDim.new(1, 0)
local mainRightFrame = Instance.new("Frame", mainFrame)
mainRightFrame.Size = UDim2.new(0, 250, 1, -35)
mainRightFrame.Position = UDim2.new(0, 180, 0, 35)
mainRightFrame.BackgroundTransparency = 1

local buttonScroll = Instance.new("ScrollingFrame", mainRightFrame)
buttonScroll.Size = UDim2.new(1, 0, 1, 0)
buttonScroll.BackgroundTransparency = 1
buttonScroll.ScrollBarThickness = 6
buttonScroll.ClipsDescendants = true

local buttonLayout = Instance.new("UIListLayout", buttonScroll)
buttonLayout.SortOrder = Enum.SortOrder.LayoutOrder
buttonLayout.Padding = UDim.new(0, 6)

local padding = Instance.new("UIPadding")
padding.Parent = buttonScroll
padding.PaddingTop = UDim.new(0, 10)    
padding.PaddingBottom = UDim.new(0, 5) 
padding.PaddingLeft = UDim.new(0, 5) 
padding.PaddingRight = UDim.new(0, 5) 

local mainLeftFrame = Instance.new("Frame", mainFrame)
mainLeftFrame.Size = UDim2.new(0, 180, 1, -35)
mainLeftFrame.Position = UDim2.new(0, 0, 0, 35)
mainLeftFrame.BackgroundTransparency = 1

local dropdown = Instance.new("TextButton", mainLeftFrame)
dropdown.Size = UDim2.new(0, 160, 0, 30)
dropdown.Position = UDim2.new(0, 10, 0, 10)
dropdown.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
dropdown.TextColor3 = Color3.new(1, 1, 1)
dropdown.Text = "Select Player"
dropdown.Font = Enum.Font.GothamBold
dropdown.TextSize = 14

local dropdownFrame = Instance.new("ScrollingFrame", mainLeftFrame)
dropdownFrame.Size = UDim2.new(0, 160, 0, 120)
dropdownFrame.Position = UDim2.new(0, 10, 0, 40)
dropdownFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
dropdownFrame.Visible = false
dropdownFrame.ClipsDescendants = true
dropdownFrame.BorderSizePixel = 0
dropdownFrame.ScrollBarThickness = 6

local uiListLayout = Instance.new("UIListLayout", dropdownFrame)
uiListLayout.SortOrder = Enum.SortOrder.LayoutOrder
uiListLayout.Padding = UDim.new(0, 4)

local tabFrame = Instance.new("Frame", titleBar)
tabFrame.Position = UDim2.new(0, 120, 0, 2)
tabFrame.Size = UDim2.new(0, 300, 1, -4)
tabFrame.BackgroundTransparency = 1
local tabLayout = Instance.new("UIListLayout", tabFrame)
tabLayout.FillDirection = Enum.FillDirection.Horizontal
tabLayout.HorizontalAlignment = Enum.HorizontalAlignment.Left
tabLayout.VerticalAlignment = Enum.VerticalAlignment.Center
tabLayout.Padding = UDim.new(0, 4) 
local function createTabButton(parentFrame, text)
	local button = Instance.new("TextButton", parentFrame)
	button.Size = UDim2.new(0.15, 0, 1, -4) 
	button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
	button.TextColor3 = Color3.new(1, 1, 1)
	button.Text = text
	button.Font = Enum.Font.GothamBold
	button.TextSize = 14
	local corner = Instance.new("UICorner", button)
	corner.CornerRadius = UDim.new(0, 6)
	return button
end
local homeButton = createTabButton(tabFrame, "Home")
local espButton = createTabButton(tabFrame, "ESP")
local otherButton = createTabButton(tabFrame, "Other")
local bloxfruitsButton = createTabButton(tabFrame, "BF")
local configButton = createTabButton(tabFrame, "Config")

local espFrame = Instance.new("Frame", mainFrame)
espFrame.Size = UDim2.new(1, 0, 1, -50)
espFrame.Position = UDim2.new(0, 0, 0, 50)
espFrame.BackgroundTransparency = 1
espFrame.Visible = false
local espLayout = Instance.new("UIListLayout")
espLayout.Parent = espFrame
espLayout.SortOrder = Enum.SortOrder.LayoutOrder
espLayout.Padding = UDim.new(0, 5) 

local otherLeftFrame = Instance.new("Frame", mainFrame)
otherLeftFrame.Size = UDim2.new(0, 180, 1, -35)
otherLeftFrame.Position = UDim2.new(0, 0, 0, 35)
otherLeftFrame.BackgroundTransparency = 1
otherLeftFrame.Visible = false

local otherRightFrame = Instance.new("Frame", mainFrame)
otherRightFrame.Size = UDim2.new(0, 250, 1, -35)
otherRightFrame.Position = UDim2.new(0, 180, 0, 35)
otherRightFrame.BackgroundTransparency = 1
otherRightFrame.Visible = false

local otherLeftScroll = Instance.new("ScrollingFrame", otherLeftFrame)
otherLeftScroll.Size = UDim2.new(1, 0, 1, 0)
otherLeftScroll.BackgroundTransparency = 1
otherLeftScroll.ScrollBarThickness = 6
otherLeftScroll.ClipsDescendants = true
	
local otherLeftLayout = Instance.new("UIListLayout", otherLeftScroll)
otherLeftLayout.SortOrder = Enum.SortOrder.LayoutOrder
otherLeftLayout.Padding = UDim.new(0, 6)

local otherRightScroll = Instance.new("ScrollingFrame", otherRightFrame)
otherRightScroll.Size = UDim2.new(1, 0, 1, 0)
otherRightScroll.BackgroundTransparency = 1
otherRightScroll.ScrollBarThickness = 6
otherRightScroll.ClipsDescendants = true

local otherRightLayout = Instance.new("UIListLayout", otherRightScroll)
otherRightLayout.SortOrder = Enum.SortOrder.LayoutOrder
otherRightLayout.Padding = UDim.new(0, 6)

local bloxfruitsLeftFrame = Instance.new("Frame", mainFrame)
bloxfruitsLeftFrame.Size = UDim2.new(0, 180, 1, -35)
bloxfruitsLeftFrame.Position = UDim2.new(0, 0, 0, 35)
bloxfruitsLeftFrame.BackgroundTransparency = 1
bloxfruitsLeftFrame.Visible = false

local bloxfruitsRightFrame = Instance.new("Frame", mainFrame)
bloxfruitsRightFrame.Size = UDim2.new(0, 250, 1, -35)
bloxfruitsRightFrame.Position = UDim2.new(0, 180, 0, 35)
bloxfruitsRightFrame.BackgroundTransparency = 1
bloxfruitsRightFrame.Visible = false

local bloxfruitsLeftScroll = Instance.new("ScrollingFrame", bloxfruitsLeftFrame)
bloxfruitsLeftScroll.Size = UDim2.new(1, 0, 1, 0)
bloxfruitsLeftScroll.BackgroundTransparency = 1
bloxfruitsLeftScroll.ScrollBarThickness = 6
bloxfruitsLeftScroll.ClipsDescendants = true

local bloxfruitsLeftLayout = Instance.new("UIListLayout", bloxfruitsLeftScroll)
bloxfruitsLeftLayout.SortOrder = Enum.SortOrder.LayoutOrder
bloxfruitsLeftLayout.Padding = UDim.new(0, 6)

local bloxfruitsRightScroll = Instance.new("ScrollingFrame", bloxfruitsRightFrame)
bloxfruitsRightScroll.Size = UDim2.new(1, 0, 1, 0)
bloxfruitsRightScroll.BackgroundTransparency = 1
bloxfruitsRightScroll.ScrollBarThickness = 6
bloxfruitsRightScroll.ClipsDescendants = true

local bloxfruitsRightLayout = Instance.new("UIListLayout", bloxfruitsRightScroll)
bloxfruitsRightLayout.SortOrder = Enum.SortOrder.LayoutOrder
bloxfruitsRightLayout.Padding = UDim.new(0, 6)

local configLeftFrame = Instance.new("Frame", mainFrame)
configLeftFrame.Size = UDim2.new(0, 180, 1, -35)
configLeftFrame.Position = UDim2.new(0, 0, 0, 35)
configLeftFrame.BackgroundTransparency = 1
configLeftFrame.Visible = false

local configRightFrame = Instance.new("Frame", mainFrame)
configRightFrame.Size = UDim2.new(0, 250, 1, -35)
configRightFrame.Position = UDim2.new(0, 180, 0, 35)
configRightFrame.BackgroundTransparency = 1
configRightFrame.Visible = false

local configLeftScroll = Instance.new("ScrollingFrame", configLeftFrame)
configLeftScroll.Size = UDim2.new(1, 0, 1, 0)
configLeftScroll.BackgroundTransparency = 1
configLeftScroll.ScrollBarThickness = 6
configLeftScroll.ClipsDescendants = true

local configLeftLayout = Instance.new("UIListLayout", configLeftScroll)
configLeftLayout.SortOrder = Enum.SortOrder.LayoutOrder
configLeftLayout.Padding = UDim.new(0, 6)

local configRightScroll = Instance.new("ScrollingFrame", configRightFrame)
configRightScroll.Size = UDim2.new(1, 0, 1, 0)
configRightScroll.BackgroundTransparency = 1
configRightScroll.ScrollBarThickness = 6
configRightScroll.ClipsDescendants = true

local configRightLayout = Instance.new("UIListLayout", configRightScroll)
configRightLayout.SortOrder = Enum.SortOrder.LayoutOrder
configRightLayout.Padding = UDim.new(0, 6)

local tpGui = Instance.new("ScreenGui")
tpGui.Name = "TPGui"
tpGui.ResetOnSpawn = false
tpGui.Parent = player:WaitForChild("PlayerGui")
tpGui.Enabled =false

local statsGui = Instance.new("ScreenGui")
statsGui.Name = "StatsGui"
statsGui.ResetOnSpawn = false
statsGui.Parent = player:WaitForChild("PlayerGui")
statsGui.Enabled =false

local statsFrame = Instance.new("Frame",statsGui)
statsFrame.Size = UDim2.new(0, 320, 0, 30)
statsFrame.Position = UDim2.new(0.03, 0, 0, 0)
statsFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
statsFrame.BackgroundTransparency = 0.2
statsFrame.Active = true

local frameCorner = Instance.new("UICorner", statsFrame)
frameCorner.CornerRadius = UDim.new(0, 12)

local statsLabel = Instance.new("TextLabel", statsFrame)
statsLabel.Size = UDim2.new(1, 0, 1, 0)
statsLabel.BackgroundTransparency = 1
statsLabel.Font = Enum.Font.GothamBold
statsLabel.TextSize = 14
statsLabel.TextColor3 = Color3.new(1,1,1)
statsLabel.TextXAlignment = Enum.TextXAlignment.Left

local function switchPage(page)
	if page == "Home" then
		mainLeftFrame.Visible = true
		mainRightFrame.Visible = true
		espFrame.Visible = false
		otherLeftFrame.Visible = false 
		otherRightFrame.Visible = false
		bloxfruitsLeftFrame.Visible = false
		bloxfruitsRightFrame.Visible = false
		configLeftFrame.Visible = false
		configRightFrame.Visible = false
	elseif page == "ESP" then
		mainLeftFrame.Visible = false
		mainRightFrame.Visible = false
		espFrame.Visible = true
		otherLeftFrame.Visible = false
		otherRightFrame.Visible = false
		bloxfruitsLeftFrame.Visible = false
		bloxfruitsRightFrame.Visible = false
		configLeftFrame.Visible = false
		configRightFrame.Visible = false
	elseif page == "Other" then
		mainLeftFrame.Visible = false
		mainRightFrame.Visible = false
		espFrame.Visible = false
		otherLeftFrame.Visible = true
		otherRightFrame.Visible = true
		bloxfruitsLeftFrame.Visible = false
		bloxfruitsRightFrame.Visible = false
		configLeftFrame.Visible = false
		configRightFrame.Visible = false
	elseif page == "Bloxfruits" then
		mainLeftFrame.Visible = false
		mainRightFrame.Visible = false
		espFrame.Visible = false
		otherLeftFrame.Visible = false
		otherRightFrame.Visible = false
		bloxfruitsLeftFrame.Visible = true
		bloxfruitsRightFrame.Visible = true
		configLeftFrame.Visible = false
		configRightFrame.Visible = false
	elseif page == "Config" then
		mainLeftFrame.Visible = false
		mainRightFrame.Visible = false
		espFrame.Visible = false
		otherLeftFrame.Visible = false
		otherRightFrame.Visible = false
		bloxfruitsLeftFrame.Visible = false
		bloxfruitsRightFrame.Visible = false
		configLeftFrame.Visible = false
		configRightFrame.Visible = false
	end 
end

homeButton.MouseButton1Click:Connect(function()
	switchPage("Home")
end)

espButton.MouseButton1Click:Connect(function()
	switchPage("ESP")
end)

otherButton.MouseButton1Click:Connect(function()
	switchPage("Other")
end)

bloxfruitsButton.MouseButton1Click:Connect(function()
	switchPage("Bloxfruits")
end)

configButton.MouseButton1Click:Connect(function()
	switchPage("Config")
end)

switchPage("Home")

local speedLabel = Instance.new("TextLabel", mainLeftFrame)
speedLabel.Size = UDim2.new(0, 80, 0, 30)
speedLabel.Position = UDim2.new(0, 10, 0, 180)
speedLabel.BackgroundTransparency = 1
speedLabel.Text = "Speed:"
speedLabel.TextColor3 = Color3.new(1, 1, 1)
speedLabel.Font = Enum.Font.GothamBold
speedLabel.TextSize = 14
speedLabel.TextXAlignment = Enum.TextXAlignment.Left

local speedBox = Instance.new("TextBox", mainLeftFrame)
speedBox.Size = UDim2.new(0, 80, 0, 30)
speedBox.Position = UDim2.new(0, 60, 0, 180)
speedBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
speedBox.TextColor3 = Color3.new(1, 1, 1)
speedBox.Text = tostring(MOVE_SPEED)
speedBox.Font = Enum.Font.GothamBold
speedBox.TextSize = 14
speedBox.ClearTextOnFocus = false
speedBox.TextEditable = true

speedBox.FocusLost:Connect(function()
	local newSpeed = tonumber(speedBox.Text)
	if newSpeed and newSpeed > 0 then
		MOVE_SPEED = newSpeed
	end
end)

local toggleButton = Instance.new("ImageButton")
toggleButton.Size = UDim2.new(0, 50, 0, 50)
toggleButton.Position = UDim2.new(0, 100, 0, 100)
toggleButton.BackgroundTransparency = 1
toggleButton.Image = "rbxassetid://125855645824065"
toggleButton.Parent = screenGui
toggleButton.Active = true
toggleButton.Draggable = true
local toggleCorner = Instance.new("UICorner", toggleButton)
toggleCorner.CornerRadius = UDim.new(0.25, 0)

toggleButton.MouseButton1Click:Connect(function()
	mainFrame.Visible = not mainFrame.Visible
end)

local function showNotification(text, color)
	local notifyFrame = Instance.new("Frame")
	notifyFrame.Size = UDim2.new(0, 200, 0, 60)
	notifyFrame.Position = UDim2.new(1, 210, 0, -70) -- 右外からスタート
	notifyFrame.BackgroundColor3 = Color3.fromRGB(42, 42, 42)
	notifyFrame.BackgroundTransparency = 0.2
	notifyFrame.BorderSizePixel = 0
	notifyFrame.Parent = screenGui

	local notifyConner = Instance.new("UICorner", notifyFrame)
	notifyConner.CornerRadius = UDim.new(0.25, 0)

	local notifyLabel = Instance.new("TextLabel", notifyFrame)
	notifyLabel.Size = UDim2.new(0.9, 0, 0.9, 0)
	notifyLabel.Position =UDim2.new(0.05,0,0.05,0)
	notifyLabel.BackgroundTransparency = 1
	notifyLabel.Text = text
	notifyLabel.TextColor3 = color
	notifyLabel.Font = Enum.Font.GothamBold
	notifyLabel.TextSize = 16
	notifyLabel.TextXAlignment = Enum.TextXAlignment.Left
	notifyLabel.TextYAlignment = Enum.TextYAlignment.Top

	local tweenIn = TweenService:Create(
		notifyFrame,
		TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
		{Position = UDim2.new(1, -210, 1, -70)} -- 右下に収まる
	)
	tweenIn:Play()

	tweenIn.Completed:Connect(function()
		task.delay(3, function()
			local tweenOut = TweenService:Create(
				notifyFrame,
				TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.In),
				{Position = UDim2.new(1, 210, 1, -70)} -- 右外に戻る
			)
			tweenOut:Play()
			tweenOut.Completed:Connect(function()
				notifyFrame:Destroy()
			end)
		end)
	end)
end

local placeId = game.PlaceId
local sea = nil

local islands = {}
local pos1
local pos2

if placeId == 4442272183 then
	bloxFruitsMode = true
	sea = "2nd"
	showNotification("Success!\nBlox Fruits Mode ON(2nd)", Color3.fromRGB(255, 255, 255))
	islands = {
		Vector3.new(-287, 305.9, 597.6),
		Vector3.new(2284.9, 14.9, 905.8),
		Vector3.new(923.2, 124.8, 32852.8),
		Vector3.new(-6508.6, 82, -132.8),
	}
	pos1 = Vector3.new(-287, 306.5, 597.9)
	pos2 = Vector3.new(938, 252.7, 32888)
elseif placeId == 7449423635 then
	bloxFruitsMode = true
	sea = "3rd"
	showNotification("Success!\nBlox Fruits Mode ON(3rd)", Color3.fromRGB(255, 255, 255))
	islands = {
		Vector3.new(-12471, 374, -7554),
		Vector3.new(5659, 1013, -341),
		Vector3.new(-5056, 315, -3180),
		Vector3.new(-12001, 332, -8861),
		Vector3.new(5319, 23, -93),
		Vector3.new(28286, 14897, 103),
	}
	pos1 = Vector3.new(-12471, 374, -7554)
	pos2 = Vector3.new(-12560,460,-7482)
end

local function updatePlayerList()
	for _, child in ipairs(dropdownFrame:GetChildren()) do
		if child:IsA("TextButton") then
			child:Destroy()
		end
	end

	for _, plr in ipairs(Players:GetPlayers()) do
		if plr ~= player then
			local btn = Instance.new("TextButton")
			btn.Size = UDim2.new(1, -10, 0, 30)
			btn.Position = UDim2.new(0, 5, 0, 0)
			btn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
			btn.TextColor3 = Color3.new(1, 1, 1)
			btn.Text = plr.Name
			btn.Font = Enum.Font.GothamBold
			btn.TextSize = 14
			btn.AutoButtonColor = true
			btn.Parent = dropdownFrame

			btn.MouseButton1Click:Connect(function()
				selectedTarget = plr
				dropdown.Text = "Target: " .. plr.Name
				dropdownFrame.Visible = false
			end)
		end
	end

	local layout = dropdownFrame:FindFirstChildOfClass("UIListLayout")
	if not layout then
		layout = Instance.new("UIListLayout")
		layout.Parent = dropdownFrame
		layout.SortOrder = Enum.SortOrder.LayoutOrder
		layout.Padding = UDim.new(0, 4)
	end
	dropdownFrame.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y)
	dropdownFrame.Visible = false
end

dropdown.MouseButton1Click:Connect(function()
	dropdownFrame.Visible = not dropdownFrame.Visible
end)
local function createSwitch(parent, text, default, callback)
	local frame = Instance.new("Frame", parent)
	frame.Size = UDim2.new(1, -10, 0, 30)
	frame.BackgroundTransparency = 0.5
	frame.BackgroundColor3 =Color3.new(0, 0, 0)
	local frameCorner = Instance.new("UICorner", frame)
	frameCorner.CornerRadius = UDim.new(0, 13)
	local label = Instance.new("TextLabel", frame)
	label.Size = UDim2.new(0.6, 0, 1, 0)
	label.Position = UDim2.new(0, 0, 0, 0)
	label.BackgroundTransparency = 1
	label.Text = text
	label.TextXAlignment = Enum.TextXAlignment.Left
	label.Font = Enum.Font.GothamBold
	label.TextSize = 14
	label.TextColor3 = Color3.new(1, 1, 1)
	local switchBase = Instance.new("Frame", frame)
	switchBase.Size = UDim2.new(0, 50, 0, 24)
	switchBase.Position = UDim2.new(1, -60, 0.5, -12)
	switchBase.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	switchBase.BackgroundTransparency = 0.3
	switchBase.Name ="SwitchBase"
	local baseCorner = Instance.new("UICorner", switchBase)
	baseCorner.CornerRadius = UDim.new(1, 0)
	local handle = Instance.new("Frame", switchBase)
	handle.Size = UDim2.new(0, 20, 0, 20)
	handle.Position = UDim2.new(0, 2, 0.5, -10)
	handle.BackgroundColor3 = Color3.new(1, 1, 1)
	local handleCorner = Instance.new("UICorner", handle)
	handleCorner.CornerRadius = UDim.new(1, 0)
	local state = default or false
	local function updateUI()
		if state then
			switchBase.BackgroundColor3 = Color3.fromRGB(0, 40, 255)
			handle:TweenPosition(UDim2.new(1, -22, 0.5, -10), "Out", "Quad", 0.2, true)
		else
			switchBase.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
			handle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
		end
	end
	switchBase.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 
			or input.UserInputType == Enum.UserInputType.Touch then
			state = not state
			updateUI()
			if callback then callback(state) end
		end
	end)
	updateUI()
	return frame
end
local function createButton(parent, text)
	local button = Instance.new("TextButton")
	button.Size = UDim2.new(1, -10, 0, 30)
	button.BackgroundColor3 = Color3.fromRGB(0, 36, 195)
	button.TextColor3 = Color3.new(1, 1, 1)
	button.Text = text
	button.Font = Enum.Font.GothamBold
	button.TextSize = 14
	button.Parent = parent
	local corner = Instance.new("UICorner", button)
	corner.CornerRadius = UDim.new(0, 13)
	return button
end
local function createInputBox(parent, text, defaultText, callback)
	local frame = Instance.new("Frame", parent)
	frame.Size = UDim2.new(1, -10, 0, 30)
	frame.BackgroundTransparency = 0.5
	frame.BackgroundColor3 = Color3.new(0, 0, 0)
	local frameCorner = Instance.new("UICorner", frame)
	frameCorner.CornerRadius = UDim.new(0, 13)
	local label = Instance.new("TextLabel", frame)
	label.Size = UDim2.new(0.6, 0, 1, 0)
	label.Position = UDim2.new(0, 0, 0, 0)
	label.BackgroundTransparency = 1
	label.Text = text
	label.TextXAlignment = Enum.TextXAlignment.Left
	label.Font = Enum.Font.GothamBold
	label.TextSize = 14
	label.TextColor3 = Color3.new(1, 1, 1)
	local inputBox = Instance.new("TextBox", frame)
	inputBox.Size = UDim2.new(0, 50, 0, 24)
	inputBox.Position = UDim2.new(1, -60, 0.5, -12)
	inputBox.BackgroundColor3 = Color3.fromRGB(176, 176, 176)
	inputBox.BackgroundTransparency = 0.3
	inputBox.Text = defaultText or ""
	inputBox.Font = Enum.Font.GothamBold
	inputBox.TextSize = 14
	inputBox.TextColor3 = Color3.new(1, 1, 1)
	inputBox.PlaceholderText = "enter..."
	inputBox.ClearTextOnFocus = false
	local corner = Instance.new("UICorner", inputBox)
	corner.CornerRadius = UDim.new(1, 0)
	inputBox.FocusLost:Connect(function()
		if callback then
			callback(inputBox.Text)
		end
	end)
	return frame
end
local refreshButton =createButton(buttonScroll,"Refresh").MouseButton1Click:Connect(function()
	updatePlayerList()
end)
local function getNearestVehicleSeat()
	local character = player.Character
	if not character or not character:FindFirstChild("HumanoidRootPart") then
		return nil
	end
	local root = character.HumanoidRootPart
	local nearestSeat = nil
	local nearestDistance = math.huge
	for _, descendant in ipairs(workspace.Boats:GetDescendants()) do
		if descendant:IsA("VehicleSeat") then
			local distance = (descendant.Position - root.Position).Magnitude
			if distance < nearestDistance then
				nearestDistance = distance
				nearestSeat = descendant
			end
		end
	end
	return nearestSeat
end
local takeShip = createButton(buttonScroll,"Take Ship")
takeShip.MouseButton1Click:Connect(function()
	if not selectedTarget or not selectedTarget.Character and bloxFruitsMode then
		return
	end
	local vehicleSeat = getNearestVehicleSeat()
	if vehicleSeat and vehicleSeat.Occupant then
		local humanoid = vehicleSeat.Occupant
		if humanoid.Parent == player.Character then
			local parent = vehicleSeat.Parent
			if parent then
				local seat = parent:FindFirstChildWhichIsA("Seat")
				if seat then
					local offset = vehicleSeat.CFrame:ToObjectSpace(seat.CFrame)

					local hrp = selectedTarget.Character:FindFirstChild("HumanoidRootPart")
					if hrp then
						local newVehicleSeatCFrame = hrp.CFrame * offset:Inverse()

						local char = player.Character
						if char and char:FindFirstChild("HumanoidRootPart") then
							char.HumanoidRootPart.CFrame = newVehicleSeatCFrame
						end
					end
				end
			end
		end
	end
end)
local function addNameEsp(plr)
	if not espEnabled then return end
	if not plr.Character or not plr.Character:FindFirstChild("Head") then return end
	if plr.Character.Head:FindFirstChild("ESP") then return end

	local billboard = Instance.new("BillboardGui")
	billboard.Name = "ESP"
	billboard.Size = UDim2.new(0, 160, 0, 30)
	billboard.StudsOffset = Vector3.new(0, 3, 0)
	billboard.AlwaysOnTop = true
	billboard.Adornee = plr.Character.Head

	local label = Instance.new("TextLabel", billboard)
	label.AnchorPoint = Vector2.new(0.5,0.5)
	label.Position = UDim2.new(0.5,0,0.5,0)
	label.Size = UDim2.new(1,0,1,0)
	label.BackgroundTransparency = 1
	label.TextColor3 = Color3.new(1,0,0)
	label.TextStrokeTransparency = 0.5
	label.Font = Enum.Font.Michroma
	label.TextScaled = true
	label.RichText = true

	billboard.Parent = plr.Character.Head

	local humanoid = plr.Character:FindFirstChild("Humanoid")
	local function updateLabel()
		local distance = 0
		if player.Character and player.Character:FindFirstChild("HumanoidRootPart") and humanoid then
			distance = (player.Character.HumanoidRootPart.Position - plr.Character.HumanoidRootPart.Position).Magnitude
		end
		label.Text = string.format(
			"<font color='rgb(255,255,255)'>%s</font> <font color='rgb(0,255,0)'> %.0f m </font>\n<font color='rgb(0,255,255)'>[%d / %d]</font>",
			plr.Name, distance, math.floor(humanoid.Health), humanoid.MaxHealth
		)
	end

	updateLabel()

	table.insert(connections, humanoid.HealthChanged:Connect(updateLabel))
	table.insert(connections, RunService.RenderStepped:Connect(updateLabel))

end
local function addBoxEsp(plr, v2)
	if not plr.Character or not plr.Character:FindFirstChild("HumanoidRootPart") then return end
	local hrp = plr.Character.HumanoidRootPart
	if hrp:FindFirstChild("BoxESP") then return end

	local box = Instance.new("BoxHandleAdornment")
	box.Name = "BoxESP"
	box.Size = v2 and Vector3.new(45,35,0.1) or Vector3.new(4,7,2)
	box.Color3 = v2 and Color3.new(0.4,0.4,0.4) or Color3.new(0,1,0)
	box.Transparency = 0.5
	box.AlwaysOnTop = true
	box.ZIndex = 5
	box.Adornee = hrp
	box.Parent = hrp
end
task.spawn(function()
	while task.wait(.1) do
		if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then continue end
		local myHRP = player.Character.HumanoidRootPart
		local myPos, onScreen1 = camera:WorldToViewportPoint(myHRP.Position)
		for _, plr in ipairs(Players:GetPlayers()) do
			if plr == player then continue end
			local char = plr.Character
			if not char or not char:FindFirstChild("HumanoidRootPart") or not char:FindFirstChild("Head") then continue end
			local hrp = char.HumanoidRootPart
			local head = char.Head
			local humanoid = char:FindFirstChild("Humanoid")
			if humanoid and humanoid.Health <= 0 then
				if head:FindFirstChild("ESP") then head.ESP:Destroy() end
				if hrp:FindFirstChild("BoxESP") then hrp.BoxESP:Destroy() end
				if tracers[plr] then
					tracers[plr]:Remove()
					tracers[plr] = nil
				end
				continue
			end
			if espEnabled and not head:FindFirstChild("ESP") then
				addNameEsp(plr)
			end
			if boxEspV1Enabled and not hrp:FindFirstChild("BoxESP") then
				addBoxEsp(plr,false)
			end
			if boxEspV2Enabled and not hrp:FindFirstChild("BoxESP") then
				addBoxEsp(plr,true)
			end
			if tracerEnabled then
				if not tracers[plr] then
					local line = Drawing.new("Line")
					line.Thickness = 2
					line.Color = Color3.fromRGB(222,225,255)
					tracers[plr] = line
				end
				local targetPos, onScreen2 = camera:WorldToViewportPoint(hrp.Position)
				local line = tracers[plr]
				if onScreen1 and onScreen2 then
					line.From = Vector2.new(myPos.X,myPos.Y)
					line.To = Vector2.new(targetPos.X,targetPos.Y)
					line.Visible = true
				else
					line.Visible = false
				end
			else
				if tracers[plr] then
					tracers[plr]:Remove()
					tracers[plr] = nil
				end
			end
		end
	end
end)
local nameespSwitch = createSwitch(espFrame, "Name ESP", false, function(state)
	espEnabled = state
	if state then
		for _, plr in ipairs(Players:GetPlayers()) do
			if plr ~= player then
				addNameEsp(plr)
			end
		end
	else
		for _, plr in ipairs(Players:GetPlayers()) do
			if plr.Character and plr.Character:FindFirstChild("Head") then
				local esp = plr.Character.Head:FindFirstChild("ESP")
				connections = nil
				if esp then esp:Destroy() end
			end
		end
	end
end)
local box1espSwitch = createSwitch(espFrame, "Box ESP V1", false, function(state)
	boxEspV1Enabled = state
	if state then
		boxEspV2Enabled = false 
		for _, plr in ipairs(Players:GetPlayers()) do
			if plr ~= player then
				addBoxEsp(plr, false)
			end
		end
	else
		for _, plr in ipairs(Players:GetPlayers()) do
			if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
				local hrp = plr.Character.HumanoidRootPart
				local box = hrp:FindFirstChild("BoxESP")
				if box then box:Destroy() end
			end
		end
	end
end)
local box2espSwitch = createSwitch(espFrame, "Box ESP V2", false, function(state)
	boxEspV2Enabled = state
	if state then
		boxEspV1Enabled = false 
		for _, plr in ipairs(Players:GetPlayers()) do
			if plr ~= player then
				addBoxEsp(plr, true)
			end
		end
	else
		for _, plr in ipairs(Players:GetPlayers()) do
			if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
				local hrp = plr.Character.HumanoidRootPart
				local box = hrp:FindFirstChild("BoxESP")
				if box then box:Destroy() end
			end
		end
	end
end)
local tracerespSwitch = createSwitch(espFrame, "Tracer ESP", false, function(state)
	tracerEnabled = state
	if state then
		for _, plr in ipairs(Players:GetPlayers()) do
			if plr ~= player and not tracers[plr] and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
				local line = Drawing.new("Line")
				line.Thickness = 2
				line.Color = Color3.fromRGB(222,225,255)
				tracers[plr] = line
			end
		end
	else
		for plr, line in pairs(tracers) do
			if line then
				line:Remove()
			end
			tracers[plr] = nil
		end
	end
end)
local movingSwitch =createSwitch(buttonScroll, "Move to Target", false, function(state)
	moving = state
end)
local moveModeSwitch =createSwitch(buttonScroll, "Tween Mode (TP/Tween)", true, function(state)
	useTween = state
end)
local camLockSwitch =createSwitch(buttonScroll, "Cam Lock", false, function(state)
	camLock = state
end)
local viewSwitch =createSwitch(buttonScroll, "Player View", false, function(state)
	playerView =state
end)
local randomSwitch =createSwitch(buttonScroll, "Random Target", false, function(state)
	randomMode = state
end)
local teamSwitch =createSwitch(buttonScroll, "Team Check", false, function(state)
	teamCheck = state
end)
local randomModeSwitch =createSwitch(buttonScroll, "Random Type (Full/Near)", true, function(state)
	randomTypeNear = state
end)
local tracerespSwitch =createSwitch(buttonScroll, "Wall Check", false, function(state)
	wallCheck = state
end)
local function setHitbox()
	for _,player in pairs(Players:GetPlayers()) do
		if player ~= game.Players.LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
			local hrp = player.Character.HumanoidRootPart
			hrp.Size = hitboxSize
			hrp.Transparency = hitboxVisible and 0.9 or 1
			hrp.BrickColor = BrickColor.new("Really blue")
			hrp.Material = Enum.Material.Neon
			hrp.CanCollide = false
		end
	end
end
local setHitboxSwitch = createSwitch(otherRightScroll, "Hitbox Enabled", false, function(state)
	if not state then
		hitboxSize = Vector3.new(2, 2, 1)
	end
	setHitbox()
end)
local hitboxSizeInput = createInputBox(otherRightScroll, "Hitbox Size", "60", function(value)
	local num = tonumber(value)
	if num then
		hitboxSize = Vector3.new(num, num, num)
		setHitbox()
	end
end)
local hitboxVisibleSwitch = createSwitch(otherRightScroll, "Hitbox Visible", false, function(state)
	hitboxVisible = state
	setHitbox()
end)
task.spawn(function()
	while task.wait(0.5) do 
		setHitbox()
	end
end)
local removeAnimationSwitch =createSwitch(otherRightScroll,"Remove Animation",false,function(state)	
	removeAnimation = state
	local character = player.Character or player.CharacterAdded:Wait()
	local humanoid = character:WaitForChild("Humanoid")
	if state then
		for _, track in ipairs(humanoid:GetPlayingAnimationTracks()) do
			track:Stop()
		end
		removeAnimationConnection = humanoid.AnimationPlayed:Connect(function(track)
			track:Stop()
		end)
	else
		if removeAnimationConnection then
			removeAnimationConnection:Disconnect()
			removeAnimationConnection = nil
		end
	end
end)
player.CharacterAdded:Connect(function(char)
	if removeAnimation and removeAnimationConnection then
		removeAnimationConnection:Disconnect()
		removeAnimationConnection = nil
		local humanoid = char:WaitForChild("Humanoid")
		removeAnimationConnection = humanoid.AnimationPlayed:Connect(function(track)
			track:Stop()
		end)
	end
end)
local noClipSwitch =createSwitch(otherRightScroll,"NoClip",false,function(state)
	if	noClipConnection then noClipConnection:Disconnect() end
	if state then
		noClipConnection = RunService.Stepped:Connect(function()
			for _, p in ipairs(game.Players.LocalPlayer.Character:GetDescendants()) do
				if p:IsA("BasePart") then p.CanCollide = false end
			end
		end)
	else
		for _, p in ipairs(game.Players.LocalPlayer.Character:GetDescendants()) do
			if p:IsA("BasePart") then p.CanCollide = true end
		end
	end
end)
local removeLavaSwitch = createSwitch(bloxfruitsRightScroll, "Remove Lava", false, function(state)
	if state then
		local targets = {"CircleIsland", "GhostShipInterior"}
		local foundLava = false

		for _, areaName in ipairs(targets) do
			local area = workspace:WaitForChild("Map"):FindFirstChild(areaName)

			if area then
				for _, obj in ipairs(area:GetDescendants()) do
					if obj.Name == "LavaParts" then
						obj:Destroy()
						showNotification("Success!\nRemoved lava", Color3.fromRGB(255, 255, 255))
						foundLava = true
					end
				end
			end
		end

		if foundLava then
			showNotification("Success!\nRemoved lava", Color3.fromRGB(255, 255, 255))
		else
			showNotification("Oops!\nLava not found", Color3.fromRGB(255, 255, 255))
		end
	end
end)
local flyguiButton =createButton(otherLeftScroll,"Fly Gui").MouseButton1Click:Connect(function()
	loadstring(game:HttpGet("https://raw.githubusercontent.com/iruka-kamone/iruka_hub/refs/heads/main/mendako"))()
end)
local FPSBoostButton =createButton(otherLeftScroll,"FPS Boost").MouseButton1Click:Connect(function()
	local decalsyeeted = true
	local g = game
	local w = g.Workspace
	local l = g.Lighting
	local t = w.Terrain    
	sethiddenproperty(l, "Technology", 2)
	sethiddenproperty(t, "Decoration", false)
	t.WaterWaveSize = 0
	t.WaterWaveSpeed = 0
	t.WaterReflectance = 0
	t.WaterTransparency = 0
	l.GlobalShadows = false
	l.FogEnd = 9e9
	l.Brightness = 0
	settings().Rendering.QualityLevel = "Level01"    
	local function optimizePart(v)
		if v:IsA("Part") or v:IsA("Union") or v:IsA("CornerWedgePart") or v:IsA("TrussPart") then
			v.Material = "Plastic"
			v.Reflectance = 0
		elseif v:IsA("Decal") or v:IsA("Texture") and decalsyeeted then
			v.Transparency = 1
		elseif v:IsA("ParticleEmitter") or v:IsA("Trail") then
			v.Lifetime = NumberRange.new(0)
		elseif v:IsA("Explosion") then
			v.BlastPressure = 1
			v.BlastRadius = 1
		elseif v:IsA("Fire") or v:IsA("SpotLight") or v:IsA("Smoke") or v:IsA("Sparkles") then
			v.Enabled = false
		elseif v:IsA("MeshPart") then
			v.Material = "Plastic"
			v.Reflectance = 0
			v.TextureID = 10385902758728957
		end
	end    
	for i, v in pairs(w:GetDescendants()) do
		if v:IsA("Part") or v:IsA("Union") or v:IsA("CornerWedgePart") or v:IsA("TrussPart") or v:IsA("MeshPart") then
			optimizePart(v)
		end
	end
	for i, e in pairs(l:GetChildren()) do
		if e:IsA("BlurEffect") or e:IsA("SunRaysEffect") or e:IsA("ColorCorrectionEffect") or e:IsA("BloomEffect") or e:IsA("DepthOfFieldEffect") then
			e.Enabled = false
		end
	end
end)
local tpSwitch = createSwitch(bloxfruitsRightScroll, "TP Gui", false, function(state)
	local tpGui = player.PlayerGui:FindFirstChild("TPGui")
	if tpGui then
		tpGui.Enabled = state
	end
end)

local function createDraggableButton(name, emoji, position, targetPos)
	local button = Instance.new("TextButton")
	button.Name = name
	button.Size = UDim2.new(0, 100, 0, 50)
	button.Position = position
	button.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
	button.Text = emoji
	button.TextScaled = true
	button.Font = Enum.Font.SourceSansBold
	button.Parent = tpGui
	local dragToggle = false
	local dragInput, dragStart, startPos
	local function update(input)
		local delta = input.Position - dragStart
		button.Position = UDim2.new(
			startPos.X.Scale, startPos.X.Offset + delta.X,
			startPos.Y.Scale, startPos.Y.Offset + delta.Y
		)
	end
	button.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
			dragToggle = true
			dragStart = input.Position
			startPos = button.Position
			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then
					dragToggle = false
				end
			end)
		end
	end)
	button.InputChanged:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
			dragInput = input
		end
	end)
	game:GetService("UserInputService").InputChanged:Connect(function(input)
		if input == dragInput and dragToggle then
			update(input)
		end
	end)
	button.MouseButton1Click:Connect(function()
		local char = player.Character or player.CharacterAdded:Wait()
		local hrp = char:WaitForChild("HumanoidRootPart")
		hrp.CFrame = CFrame.new(targetPos)
		moving =false
		for _, child in ipairs(buttonScroll:GetChildren()) do
			if child:IsA("Frame") and child:FindFirstChild("SwitchBase") and child:FindFirstChildOfClass("TextLabel") then
				if child:FindFirstChildOfClass("TextLabel").Text == "Move to Target" then
					local switchBase = child:FindFirstChild("SwitchBase")
					if switchBase then
						local handle = switchBase:FindFirstChildOfClass("Frame")
						if handle then
							handle:TweenPosition(UDim2.new(0, 2, 0.5, -10), "Out", "Quad", 0.2, true)
							switchBase.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
						end
					end
				end
			end
		end
	end)
end
if bloxFruitsMode and sea == "2nd" then
	createDraggableButton("Dolphin", "🐬", UDim2.new(0, 10, 0, 10), pos1)
	createDraggableButton("Anchor", "⚓", UDim2.new(0, 120, 0, 10), pos2)
elseif bloxFruitsMode and sea =="3rd" then
	createDraggableButton("Mansion", "🏨", UDim2.new(0, 10, 0, 10), pos1)
	createDraggableButton("Tiki", "⚓", UDim2.new(0, 120, 0, 10), pos2)
end
local changeTeamButton =createButton(bloxfruitsLeftScroll,"Change Team").MouseButton1Click:Connect(function()
	if player.Team == "Pirates" then
		game:GetService("ReplicatedStorage").Remotes.CommF_:InvokeServer("SetTeam", "Marines")
	else
		game:GetService("ReplicatedStorage").Remotes.CommF_:InvokeServer("SetTeam", "Pirates")
	end
end)
local walkWaterSwitch =createSwitch(bloxfruitsRightScroll,"Walk Water",false,function(state)
	if state then
		(game:GetService("Workspace")).Map["WaterBase-Plane"].Size = Vector3.new(1000, 112, 1000);
	else
		(game:GetService("Workspace")).Map["WaterBase-Plane"].Size = Vector3.new(1000, 80, 1000);
	end;
end)
local aimbotSwitch =createSwitch(bloxfruitsRightScroll,"Aimbot Enabled",false,function(state)
	aimbotSkill = state
end)
spawn(function()
	while task.wait() do
		local char = player.Character
		if not char or not char:FindFirstChild("HumanoidRootPart") then 
			nearestEnemyPos = nil
			return 
		end

		local myPos = char.HumanoidRootPart.Position
		local nearestDist = math.huge
		local nearestEnemy = nil

		for _, other in ipairs(Players:GetPlayers()) do
			if other ~= player then
				local enemyChar = other.Character
				if enemyChar and enemyChar:FindFirstChild("HumanoidRootPart") then
					local dist = (enemyChar.HumanoidRootPart.Position - myPos).Magnitude
					if dist < nearestDist then
						nearestDist = dist
						nearestEnemy = enemyChar
					end
				end
			end
		end

		if nearestEnemy then
			nearestEnemyPos = nearestEnemy.HumanoidRootPart.Position
		else
			nearestEnemyPos = nil
		end
	end
end)
--[[pcall(function()
	spawn(function()
		local gg = getrawmetatable(game)
		local old = gg.__namecall
		setreadonly(gg,false)
		gg.__namecall = newcclosure(function(...)
			local method = getnamecallmethod()
			local args = {...}
			if tostring(method) == "FireServer" then
				if tostring(args[1]) == "RemoteEvent" then
					if tostring(args[2]) ~= "true" and tostring(args[2]) ~= "false" then
						if aimbotSkill then
							if type(args[2]) == "vector" then
								args[2] = nearestEnemyPos
							else
								args[2] = CFrame.new(nearestEnemyPos)
							end
							return old(unpack(args))
						end
					end
				end
			end
			return old(...)
		end)
	end)
end)--]]

local function IsEntityAlive(entity)
	if not entity then return false end
	local humanoid = entity:FindFirstChild("Humanoid")
	return humanoid and humanoid.Health > 0
end

local function GetEnemiesInRange(character, range)
	local enemies = game:GetService("Workspace").Enemies:GetChildren()
	local players = game:GetService("Players"):GetPlayers()
	local targets = {}
	local playerPos = character:GetPivot().Position
	for _, enemy in ipairs(enemies) do
		local rootPart = enemy:FindFirstChild("HumanoidRootPart")
		if rootPart and IsEntityAlive(enemy) then
			local distance = (rootPart.Position - playerPos).Magnitude
			if distance <= range then
				table.insert(targets, enemy)
			end
		end
	end
	for _, otherPlayer in ipairs(players) do
		if otherPlayer ~= player and otherPlayer.Character then
			local rootPart = otherPlayer.Character:FindFirstChild("HumanoidRootPart")
			if rootPart and IsEntityAlive(otherPlayer.Character) then
				local distance = (rootPart.Position - playerPos).Magnitude
				if distance <= range then
					table.insert(targets, otherPlayer.Character)
				end
			end
		end
	end
	return targets
end

local function attackNoCoolDown()
	local character = player.Character
	local hrp = character:FindFirstChild("HumanoidRootPart")
	if not hrp then return end
	local equippedWeapon
	for _, item in ipairs(character:GetChildren()) do
		if item:IsA("Tool") then
			equippedWeapon = item
			break
		end
	end
	if not equippedWeapon then return end
	if hrp:FindFirstChild("Buddha") and superRange then
		attackRange =1000
	else
		attackRange =60
	end
	local enemiesInRange = GetEnemiesInRange(character, attackRange)
	if equippedWeapon:FindFirstChild("LeftClickRemote") then
		local attackCount = 1  
		for _, enemy in ipairs(enemiesInRange) do
			local rootPart = enemy:FindFirstChild("HumanoidRootPart")
			if rootPart then
				local direction = (rootPart.Position - character:GetPivot().Position).Unit
				equippedWeapon.LeftClickRemote:FireServer(direction, attackCount)
				attackCount = attackCount + 1
			end
		end
	else
		local targets, mainTarget = {}, nil
		for _, enemy in ipairs(enemiesInRange) do
			if not enemy:GetAttribute("IsBoat") then
				local head = enemy:FindFirstChild("Head")
				if head then
					table.insert(targets, { enemy, head })
					mainTarget = head
				end
			end
		end
		if mainTarget then
			local attackEvent = ReplicatedStorage:WaitForChild("Modules"):WaitForChild("Net"):WaitForChild("RE/RegisterAttack")
			local hitEvent = ReplicatedStorage:WaitForChild("Modules"):WaitForChild("Net"):WaitForChild("RE/RegisterHit")
			pcall(function()
				attackEvent:FireServer(0.1)
				hitEvent:FireServer(mainTarget, targets)
			end)
		end
	end
end
local fastAttack = false
task.spawn(function()
	while task.wait(0.1) do
		if fastAttack then
			attackNoCoolDown()
		end
	end
end)
local fastAttackSwitch =createSwitch(bloxfruitsRightScroll,"Fast Attack", false,function(state)
	fastAttack = state
end)
local superRangeSwitch = createSwitch(bloxfruitsRightScroll, "Super Range(Buddha Only)", false, function(state)
	superRange = state
end)
local SpeedConnection
local function ApplySpeed()
	local Character = player.Character
	if Character then
		local Humanoid = Character:FindFirstChildOfClass("Humanoid")
		if Humanoid then
			if speedHack and walkSpeed then
				if SpeedConnection then
					SpeedConnection:Disconnect()
				end
				Humanoid.WalkSpeed = walkSpeed
				SpeedConnection = Humanoid:GetPropertyChangedSignal("WalkSpeed"):Connect(function()
					if speedHack then
						Humanoid.WalkSpeed = walkSpeed
					end
				end)
			else
				Humanoid.WalkSpeed = 16
				if SpeedConnection then
					SpeedConnection:Disconnect()
				end
			end
		end
	end
end
local speedHackSwitch = createSwitch(otherRightScroll,"Speed Hack",false,function(state)
	speedHack = state
	ApplySpeed()
end)
local speedHackInput =createInputBox(otherRightScroll,"Speed Value","16",function(value)
	local num =tonumber(value)
	if num and num >= 0 then
		walkSpeed =num
		ApplySpeed()
	end
end)
local JumpConnection
local function ApplyJumpPower()
	local Character = player.Character
	if Character then
		local Humanoid = Character:FindFirstChildOfClass("Humanoid")
		if Humanoid then
			if jumpHack and jumpPower then
				if JumpConnection then
					JumpConnection:Disconnect()
				end
				Humanoid.UseJumpPower = true
				Humanoid.JumpPower = jumpPower
				print(jumpPower)
				JumpConnection = Humanoid:GetPropertyChangedSignal("JumpPower"):Connect(function()
					if jumpHack then
						Humanoid.JumpPower = jumpPower
					end
				end)
			else
				Humanoid.JumpPower = 50
				if JumpConnection then
					JumpConnection:Disconnect()
				end
			end
		end
	end
end
local jumpHackSwitch = createSwitch(otherRightScroll,"Jump Hack",false,function(state)
	jumpHack = state
	ApplyJumpPower()
end)
local jumpHackInput = createInputBox(otherRightScroll,"Jump Value","50",function(value)
	local num =tonumber(value)
	if num and num >= 0 then
		jumpPower =num
		ApplyJumpPower()
	end
end)
local statsSwitch = createSwitch(otherRightScroll, "Stats Gui", false, function(state)
	statsGui.Enabled = state
	RunService.Heartbeat:Connect(function()
		frameCount += 1
		local now = tick()
		if now - lastTime >= 1 then
			fps = frameCount / (now - lastTime)
			frameCount = 0
			lastTime = now
		end
		local pos = player.Character and player.Character:FindFirstChild("HumanoidRootPart") and player.Character.HumanoidRootPart.Position or Vector3.new(0,0,0)
		local ping = math.floor(player:GetNetworkPing() * 1000) 
		statsLabel.Text = string.format("FPS: %d | Ping: %dms | POS: (%.1f, %.1f, %.1f)", fps, ping, pos.X, pos.Y, pos.Z)
	end)
end)
local fightingShopButton = createButton(bloxfruitsLeftScroll, "Fightings Shop Gui")
fightingShopButton.MouseButton1Click:Connect(function()
	loadstring(game:HttpGet("https://raw.githubusercontent.com/iruka-kamone/iruka_hub/refs/heads/main/sirokuma"))()
end)
local killAuraButton =createButton(bloxfruitsLeftScroll,"Raid Kill Aura Gui")
killAuraButton.MouseButton1Click:Connect(function()
	loadstring(game:HttpGet("https://raw.githubusercontent.com/iruka-kamone/iruka_hub/refs/heads/main/azarasi"))()
end)
local fixCameraShakeButton =createButton(bloxfruitsLeftScroll,"Fix CameraShake")
fixCameraShakeButton.MouseButton1Click:Connect(function()
	local Util = ReplicatedStorage:WaitForChild("Util", 5)
	if Util then
		local CameraShaker = Util:FindFirstChild("CameraShaker")
		if CameraShaker then
			require(CameraShaker):Stop()
		end
	end
end)

if not bloxFruitsMode then

	local bloxfruitsGui ={takeShip,removeLavaSwitch,tpSwitch,aimbotSwitch,fightingShopButton,killAuraButton,fastAttackSwitch,superRangeSwitch,fixCameraShakeButton}

	for i,switch in ipairs(bloxfruitsGui) do
		if switch:FindFirstChild("SwitchBase") then
			switch.SwitchBase.Visible =false
			switch.BackgroundColor3 = Color3.fromRGB(100, 100, 100) -- 灰色
			switch.Active = false
			switch.TextLabel.Text ="Bloxfruits only"
			switch.TextLabel.TextTransparency =0.5
		else 
			switch.BackgroundColor3 = Color3.fromRGB(100, 100, 100) -- 灰色
			switch.Active = false
			switch.Text ="Bloxfruits only"
			switch.TextTransparency =0.5
		end
	end
end
-- 🟢 Look Part ドロップダウン
local lookParts = {"Head", "Torso","Legs"}
local currentLookPart = "Head"

local lookDropdownFrame = Instance.new("Frame", buttonScroll)
lookDropdownFrame.Size = UDim2.new(1, -10, 0, 40)
lookDropdownFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
lookDropdownFrame.BackgroundTransparency = 0.3

local dropdownCorner = Instance.new("UICorner", lookDropdownFrame)
dropdownCorner.CornerRadius = UDim.new(0, 8)

local dropdownLabel = Instance.new("TextLabel", lookDropdownFrame)
dropdownLabel.Size = UDim2.new(1, -20, 1, 0)
dropdownLabel.Position = UDim2.new(0, 10, 0, 0)
dropdownLabel.BackgroundTransparency = 1
dropdownLabel.Text = "Look Part: " .. currentLookPart
dropdownLabel.Font = Enum.Font.GothamBold
dropdownLabel.TextSize = 14
dropdownLabel.TextColor3 = Color3.new(1, 1, 1)
dropdownLabel.TextXAlignment = Enum.TextXAlignment.Left

lookDropdownFrame.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		local index = table.find(lookParts, currentLookPart)
		local nextIndex = index % #lookParts + 1
		currentLookPart = lookParts[nextIndex]
		dropdownLabel.Text = "Look Part: " .. currentLookPart
		camLockPart = currentLookPart
	end
end)

-- スクロール範囲自動調整
buttonLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
	buttonScroll.CanvasSize = UDim2.new(0, 0, 0, buttonLayout.AbsoluteContentSize.Y + 20)
end)

buttonScroll.CanvasSize = UDim2.new(0, 0, 0, buttonLayout.AbsoluteContentSize.Y + 40)

-- Raycast でターゲットとの間に壁があるかチェック
local function isVisible(target)
	if not target.Character or not target.Character:FindFirstChild("HumanoidRootPart") then
		return false
	end
	if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then
		return false
	end

	local origin = player.Character.HumanoidRootPart.Position

	local targetPos
	if camLockPart == "Head" and target.Character:FindFirstChild("Head") then
		targetPos = target.Character.Head.Position
	elseif camLockPart == "Torso" and target.Character:FindFirstChild("HumanoidRootPart") then
		targetPos = target.Character.HumanoidRootPart.Position
	elseif camLockPart == "Legs" and target.Character:FindFirstChild("HumanoidRootPart") then
		targetPos = target.Character.HumanoidRootPart.Position - Vector3.new(0, 3, 0)
	else
		targetPos = target.Character.HumanoidRootPart.Position
	end

	local direction = targetPos - origin

	local raycastParams = RaycastParams.new()
	raycastParams.FilterDescendantsInstances = {player.Character, target.Character}
	raycastParams.FilterType = Enum.RaycastFilterType.Blacklist

	local result = workspace:Raycast(origin, direction, raycastParams)
	if result then
		-- 途中で遮蔽物に当たった
		return false
	end
	return true
end

-- Pick random target based on settings
local function pickRandomTarget()
	local candidates = {}
	for _, plr in ipairs(Players:GetPlayers()) do
		if plr ~= player and plr.Character and plr.Character:FindFirstChild("Humanoid") and plr.Character.Humanoid.Health > 0 then

			if not teamCheck and player.Team and plr.Team == player.Team then
			else
				if not wallCheck or isVisible(plr) then
					table.insert(candidates, plr)
				end
			end
		end
	end

	if #candidates == 0 then
		selectedTarget = nil
		dropdown.Text = "Select Player"
		return
	end

	if randomTypeNear then
		table.sort(candidates, function(a,b)
			if not (a.Character and a.Character:FindFirstChild("HumanoidRootPart")) then return false end
			if not (b.Character and b.Character:FindFirstChild("HumanoidRootPart")) then return true end
			local aPos = a.Character.HumanoidRootPart.Position
			local bPos = b.Character.HumanoidRootPart.Position
			local myPos = player.Character and player.Character:FindFirstChild("HumanoidRootPart") and player.Character.HumanoidRootPart.Position or Vector3.new()
			return (aPos - myPos).Magnitude < (bPos - myPos).Magnitude
		end)
		selectedTarget = candidates[1]
	else
		if selectedTarget and selectedTarget.Character and selectedTarget.Character:FindFirstChild("Humanoid") and selectedTarget.Character.Humanoid.Health > 0 then
			return
		end
		selectedTarget = candidates[math.random(1,#candidates)]
	end

	if selectedTarget then
		dropdown.Text = "Target: " .. selectedTarget.Name
	end
end

updatePlayerList()

closeButton.MouseButton1Click:Connect(function()
	local confirmFrame = Instance.new("Frame")
	confirmFrame.Size = UDim2.new(0.3,0,0.4,0)
	confirmFrame.Position = UDim2.new(0.35, 0, 0.3, 0)
	confirmFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	confirmFrame.BackgroundTransparency = 0.2
	confirmFrame.BorderSizePixel = 0
	confirmFrame.Parent = screenGui
	confirmFrame.ZIndex = 10

	local label = Instance.new("TextLabel", confirmFrame)
	label.Size = UDim2.new(1, 0, 0.2, 0)
	label.Position = UDim2.new(0, 0, 0.1, 0)
	label.BackgroundTransparency = 1
	label.Text = "Really Close?"
	label.TextColor3 = Color3.new(1,1,1)
	label.Font = Enum.Font.GothamBold
	label.TextSize = 18
	label.TextWrapped = true
	label.ZIndex =11

	local yesButton = Instance.new("TextButton", confirmFrame)
	yesButton.Size = UDim2.new(0.3, 0, 0.3, 0)
	yesButton.Position = UDim2.new(0.1, 0, 0.6, 0)
	yesButton.BackgroundColor3 = Color3.fromRGB(180, 50, 50)
	yesButton.TextColor3 = Color3.new(1,1,1)
	yesButton.Text = "Yes"
	yesButton.Font = Enum.Font.GothamBold
	yesButton.TextSize = 16
	yesButton.ZIndex = 11

	local noButton = Instance.new("TextButton", confirmFrame)
	noButton.Size = UDim2.new(0.3, 0, 0.3, 0)
	noButton.Position = UDim2.new(0.6, 0, 0.6, 0)
	noButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
	noButton.TextColor3 = Color3.new(1,1,1)
	noButton.Text = "Cancel"
	noButton.Font = Enum.Font.GothamBold
	noButton.TextSize = 16
	noButton.ZIndex =11
	local uicorner =Instance.new("UICorner",confirmFrame)
	uicorner.CornerRadius = UDim.new(0.1,0)
	yesButton.MouseButton1Click:Connect(function()
		screenGui:Destroy()
		destroyFollowPlatform()
	end)
	noButton.MouseButton1Click:Connect(function()
		confirmFrame:Destroy()
	end)
end)

local function teleportTo(position)
	if not player.Character then return end
	local hrp = player.Character:FindFirstChild("HumanoidRootPart")
	if not hrp then return end

	if not followPlatform or not followPlatform.Parent then
		createFollowPlatform(hrp.Position - Vector3.new(0, 2.5, 0))
	end
	if currentTween then
		currentTween:Cancel()
		currentTween = nil
	end
	if useTween then
		local distance = (position - followPlatform.Position).Magnitude
		local time = distance / MOVE_SPEED

		currentTween = TweenService:Create(
			followPlatform,
			TweenInfo.new(time, Enum.EasingStyle.Linear, Enum.EasingDirection.Out),
			{Position = position}
		)

		if followPlatform and followPlatform.Parent and hrp.Parent then
			hrp.CFrame = CFrame.new(
				followPlatform.Position + Vector3.new(0, 2.5, 0)
			)
		end
		currentTween:Play()
	else
		hrp.CFrame = CFrame.new(position + Vector3.new(0, 2.5, 0))
	end
end

local function getClosestIslandToTarget(targetPos)
	local closestIsland = nil
	local closestDist = math.huge
	for _, island in ipairs(islands) do
		local dist = (targetPos - island).Magnitude
		if dist < closestDist then
			closestDist = dist
			closestIsland = island
		end
	end
	return closestIsland, closestDist
end

RunService.Heartbeat:Connect(function()
	local cam = workspace.CurrentCamera

	if playerView and selectedTarget and selectedTarget.Character and selectedTarget.Character:FindFirstChild("Humanoid") then
		cam.CameraSubject = selectedTarget.Character:FindFirstChild("Humanoid")
		return
	end
	if camLock and selectedTarget and selectedTarget.Character then
		local lookPos = nil
		if camLockPart == "Head" and selectedTarget.Character:FindFirstChild("Head") then
			lookPos = selectedTarget.Character.Head.Position
		elseif camLockPart == "Torso" and selectedTarget.Character:FindFirstChild("HumanoidRootPart") then
			lookPos = selectedTarget.Character.HumanoidRootPart.Position
		elseif camLockPart == "Legs" and selectedTarget.Character:FindFirstChild("HumanoidRootPart") then
			lookPos = selectedTarget.Character.HumanoidRootPart.Position - Vector3.new(0, 3, 0)
		end

		if lookPos then
			cam.CFrame = CFrame.new(cam.CFrame.Position, lookPos)
		end
	else
		if Players.LocalPlayer.Character and Players.LocalPlayer.Character:FindFirstChild("Head") then
			cam.CameraSubject = Players.LocalPlayer.Character:FindFirstChild("Humanoid")
		end
	end
end)

local lastDistance = nil 

RunService.Heartbeat:Connect(function()
	if randomMode then
		if randomTypeNear then
			pickRandomTarget()
		end
	end

	if moving and selectedTarget and selectedTarget.Character and selectedTarget.Character:FindFirstChild("HumanoidRootPart") then
		local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
		if hrp then
			local targetPos = selectedTarget.Character.HumanoidRootPart.Position - Vector3.new(0, 3, 0)
			local distance = (hrp.Position - targetPos).Magnitude
			if bloxFruitsMode then
				local island, islandDist = getClosestIslandToTarget(targetPos)
				if island then
					local myDist = (hrp.Position - targetPos).Magnitude
					if islandDist < myDist then
						hrp.CFrame = CFrame.new(island)
						destroyFollowPlatform()
						teleportTo(targetPos)
						lastDistance = distance
						return
					end
				end
				if lastDistance and (distance - lastDistance) > 2000 then
					if island and islandDist < (hrp.Position - targetPos).Magnitude then
						hrp.CFrame = CFrame.new(island)
						destroyFollowPlatform()
						teleportTo(targetPos)
						lastDistance = distance
						return
					else
						destroyFollowPlatform()
						moving = false
						lastDistance = nil
						return
					end
				end
			end
			teleportTo(targetPos)
			lastDistance = distance
		end
	else
		destroyFollowPlatform()
		lastDistance = nil
	end
end)
